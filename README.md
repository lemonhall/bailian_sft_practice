# 企业内部流程训练数据生成器

## 功能描述

这个Python程序用于调用百炼的qwen-plus模型生成企业内部流程相关的对话训练数据，生成的数据格式与您提供的JSONL文件完全一致。

## 主要特性

- ✅ 支持15大企业流程类别：报销、请假、采购、人事、IT、财务、行政、项目、质量管理、安全管理、客户服务、法务合规、市场营销、研发技术、生产运营
- ✅ 每个类别包含多个具体场景，总计180个不同场景
- ✅ 优化提示词设计，确保生成专业、详细的流程步骤
- ✅ 自动调用百炼qwen-plus模型生成自然的对话
- ✅ 输出标准JSONL格式，可直接用于模型训练
- ✅ 内置API限流控制，避免调用过于频繁
- ✅ 支持自定义生成数量和输出文件名

## 安装依赖

```bash
pip install openai
```

注意：我们使用OpenAI库来访问百炼的兼容接口，这是阿里云推荐的方式。

## 使用前准备

### 1. 获取百炼API Key

1. 访问 [阿里云百炼平台](https://bailian.console.aliyun.com/)
2. 注册并登录账号
3. 创建应用并获取API Key

### 2. 配置API Key

方式一：设置环境变量（推荐）
```bash
# Windows
set DASHSCOPE_API_KEY=your-actual-api-key

# Linux/Mac
export DASHSCOPE_API_KEY=your-actual-api-key
```

方式二：直接修改代码
在 `generate_enterprise_data.py` 文件中修改：
```python
DASHSCOPE_API_KEY = "your-actual-api-key"
```

## 使用方法

### 基本使用

```bash
python generate_enterprise_data.py
```

### 程序流程

1. 程序会自动检查API Key配置
2. 按8个类别依次生成对话数据
3. 每个场景生成多个不同的对话
4. 实时显示生成进度
5. 自动保存为JSONL格式

### 生成的数据格式

```json
{
  "messages": [
    {
      "role": "system",
      "content": "你是一个专业的企业内部流程助手，负责帮助员工处理各种企业内部事务..."
    },
    {
      "role": "user", 
      "content": "我想申请报销差旅费，需要准备什么材料？"
    },
    {
      "role": "assistant",
      "content": "您好！申请差旅费报销需要准备以下材料：1. 填写完整的差旅费报销申请表..."
    }
  ]
}
```

## 支持的企业流程场景

### 报销类（8个场景）
- 差旅费报销流程
- 餐费报销  
- 办公用品报销
- 培训费用报销
- 交通费报销
- 住宿费报销
- 招待费报销
- 通讯费报销

### 请假类（8个场景）
- 病假申请
- 事假申请
- 年假申请
- 婚假申请
- 产假申请
- 陪产假申请
- 丧假申请
- 调休申请

### 采购类（8个场景）
- 办公设备采购
- 软件采购
- 服务采购
- 原材料采购
- 供应商选择
- 采购合同审批
- 验收流程
- 付款申请

### 人事类（8个场景）
- 入职手续办理
- 离职手续办理
- 转正申请
- 调岗申请
- 薪资调整
- 绩效考核
- 培训申请
- 证件补办

### IT类（8个场景）
- 账号开通申请
- 权限申请
- 设备申请
- 软件安装
- 网络问题报修
- 系统故障报告
- 密码重置
- VPN申请

### 财务类（8个场景）
- 发票申请
- 开票信息变更
- 合同付款
- 预算申请
- 成本核算
- 资金调拨
- 银行开户
- 税务申报

### 行政类（8个场景）
- 会议室预定
- 车辆申请
- 快递寄送
- 文件打印
- 访客登记
- 停车申请
- 食堂订餐
- 工牌补办

### 项目类（8个场景）
- 项目立项
- 项目变更
- 项目结项
- 资源申请
- 进度汇报
- 风险上报
- 质量检查
- 验收申请

## 自定义配置

### 修改生成数量

在 `main()` 函数中修改：
```python
generator.generate_dataset(target_count=300, output_file="my_data.jsonl")
```

### 修改输出文件名

```python
generator.generate_dataset(target_count=200, output_file="custom_name.jsonl")
```

### 添加新的场景

在 `enterprise_scenarios` 列表中添加新的类别或场景：
```python
{"category": "新类别", "scenarios": [
    "场景1", "场景2", "场景3"
]}
```

## 注意事项

1. **API调用限制**：程序内置了0.5秒的调用间隔，避免触发API限流
2. **网络连接**：需要稳定的网络连接访问百炼API
3. **API费用**：每次调用会产生一定费用，请注意控制生成数量
4. **数据质量**：生成的数据质量依赖于模型表现，建议生成后进行人工审核
5. **编码格式**：输出文件使用UTF-8编码，支持中文字符

## 故障排除

### 1. API Key错误
```
请检查API Key是否正确配置，确保有qwen-plus的调用权限
```

### 2. 网络连接失败
```
检查网络连接，确保可以访问 dashscope.aliyuncs.com
```

### 3. 生成数据为空
```
检查API返回内容，可能需要调整提示词或模型参数
```

### 4. 编码问题
```
确保终端支持UTF-8编码显示中文字符
```

## 输出示例

程序运行时会显示如下信息：
```
开始生成企业流程训练数据，目标数量: 200

处理类别: 报销
  生成场景: 差旅费报销流程
    成功生成第 1 条数据
    成功生成第 2 条数据
  ...

数据生成完成！
总数量: 200
已保存到: enterprise_training_data.jsonl
```

生成的数据可以直接用于大模型的微调训练。